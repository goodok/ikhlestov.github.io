<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ubuntu bash hints | Illarion Khlestov Blog</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.xml">
<link rel="canonical" href="https://ikhlestov.github.io/pages/another-topics/ubuntu-bash-hints/">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    displayAlign: 'center', // Change this to 'center' to center equations.
});
</script><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Illarion Khlestov">
<meta property="og:site_name" content="Illarion Khlestov Blog">
<meta property="og:title" content="Ubuntu bash hints">
<meta property="og:url" content="https://ikhlestov.github.io/pages/another-topics/ubuntu-bash-hints/">
<meta property="og:description" content="Contents

Continue run script after interrupting ssh session
Another hints



Continue run script after interrupting ssh session
When you close ssh session, scripts that were called from ssh user may ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-11-11T11:55:53Z">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ikhlestov.github.io/">

                <span id="blog-title">Illarion Khlestov Blog</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../">Blog</a>
                </li>
<li>
<a href="../../">Pages</a>
                </li>
<li>
<a href="../../../listings/">Listings</a>
                </li>
<li>
<a href="../../../archive.html">Archive</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Ubuntu bash&nbsp;hints</a></h1>

        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#continue-run-script-after-interrupting-ssh-session" id="id1">Continue run script after interrupting ssh&nbsp;session</a></li>
<li><a class="reference internal" href="#another-hints" id="id2">Another&nbsp;hints</a></li>
</ul>
</div>
<div class="section" id="continue-run-script-after-interrupting-ssh-session">
<h2><a class="toc-backref" href="#id1">Continue run script after interrupting ssh&nbsp;session</a></h2>
<p>When you close ssh session, scripts that were called from ssh user may be closed. To handle this situation you may run scripts under the sudo. Or use tmux. What we should&nbsp;do:</p>
<ul class="simple">
<li>Connect to VPN, required server <tt class="docutils literal">ssh username@host_ip</tt>
</li>
<li>Install tmux - <tt class="docutils literal">sudo <span class="pre">apt-get</span> install tmux</tt>
</li>
<li>Open new tmux session <tt class="docutils literal">tmux new <span class="pre">-s</span> session_name</tt>
</li>
<li>Run desired&nbsp;script.</li>
<li>Detach session with hotkey <tt class="docutils literal">ctrl+b ++ d</tt> (Means press <tt class="docutils literal">ctrl + b</tt> first and after the <tt class="docutils literal">d</tt>)</li>
<li>You may reconnect at this point to the&nbsp;server</li>
<li>List all tmux session <tt class="docutils literal">tmux ls</tt>
</li>
<li>Connect to chosen session with <tt class="docutils literal">tmux a <span class="pre">-t</span> session_name</tt>
</li>
<li>Kill session from itself if not required any more <tt class="docutils literal">ctrl+b ++ x</tt>
</li>
</ul>
<p>Additional&nbsp;notes:</p>
<ul class="simple">
<li>In case of mouse scrolling not works - inside tmux type <tt class="docutils literal">tmux <span class="pre">set-option</span> <span class="pre">-g</span> mouse on</tt>
</li>
<li>If you want to be sure that tmux session will not be stopped - you may open new window under the sudo <tt class="docutils literal">sudo tmux new <span class="pre">-s</span> window_name</tt> and after inside change the user <tt class="docutils literal">su - username</tt>
</li>
<li>Here exist quite full <a class="reference external" href="https://gist.github.com/MohamedAlaa/2961058">cheat sheet for&nbsp;tmux</a>
</li>
<li>Copy from tmux screen can be some way inconvinient - so it&#8217;s better to store output in some file: <tt class="docutils literal">./script_name | tee <span class="pre">-a</span> logs.txt</tt>
</li>
<li>In case you want to copy something - you may just highlight by mouse required region, and to past press <tt class="docutils literal">ctrl+b ++ ]</tt>
</li>
</ul>
<p>Tmux is very powerful tool with many other capabilities. For example you may work in one session with your&nbsp;team.</p>
</div>
<div class="section" id="another-hints">
<h2><a class="toc-backref" href="#id2">Another&nbsp;hints</a></h2>
<ul class="simple">
<li>
<a class="reference external" href="https://github.com/jlevy/the-art-of-command-line/blob/master/README.md">one page bash tutorial</a> <a class="reference external" href="https://github.com/jlevy/the-art-of-command-line/blob/master/README-ru.md">(ru)</a>
</li>
<li><a class="reference external" href="https://explainshell.com/">bash command explanation(explain&nbsp;shell)</a></li>
</ul>
<p><a class="reference external" href="../../../listings/ubuntu-bash-hints.sh.html">ubuntu-bash-hints.sh</a>  <a class="reference external" href="../../../listings/ubuntu-bash-hints.sh">(Source)</a></p>
<pre class="code bash"><a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-1"></a><span class="c1"># show running process by name with headers</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-2"></a>$ ps aux <span class="p">|</span> egrep <span class="s2">"python|PID"</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-3"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-4"></a><span class="c1">### la</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-5"></a><span class="c1"># sizes of files</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-6"></a>$ ls -lah
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-7"></a><span class="c1"># colored</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-8"></a>$ ls -G
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-9"></a><span class="c1"># count quantity of files inside folder</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-10"></a>$ ls -1 <span class="p">|</span> wc -l
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-11"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-12"></a><span class="c1">### sizes</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-13"></a><span class="c1"># check free disk space</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-14"></a>$ df -h
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-15"></a><span class="c1"># get folder size</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-16"></a>$ du -hs
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-17"></a><span class="c1"># get folders size inside another one</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-18"></a>$ du -h --max-depth<span class="o">=</span><span class="m">1</span> some_folder
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-19"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-20"></a><span class="c1">### search</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-21"></a><span class="c1"># search recursive by folders</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-22"></a>$ grep -r <span class="s2">"/api/Profile/active_home_devices"</span> static/
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-23"></a><span class="c1"># search by file content</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-24"></a>$ grep -R <span class="s1">'GCModel'</span> SemanticProcessor/
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-25"></a><span class="c1"># find by filename</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-26"></a>$ find ~ -name readme.txt
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-27"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-28"></a><span class="c1">### zipping/unzipping</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-29"></a><span class="c1"># unzip tar.gz file</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-30"></a>$ tar -xvzf filename.tar.gz
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-31"></a><span class="c1"># zip something</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-32"></a>$ zip archive_name source_name
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-33"></a><span class="c1"># unzip something</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-34"></a>$ unzip archive_name
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-35"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-36"></a><span class="c1"># execute output of some command(assume it in text file)</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-37"></a>$ <span class="k">$(</span>cat filename<span class="k">)</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-38"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-39"></a><span class="c1"># get the location of the executable link</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-40"></a>$ readlink -f /usr/bin/java
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-41"></a>/usr/lib/jvm/java-8-oracle/jre/bin/java
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-42"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-43"></a><span class="c1"># display part of the file</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-44"></a>$ cat filename <span class="p">|</span> less
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-45"></a>$ tail -200 filename
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-46"></a>$ head -200 filename
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-47"></a>$ head -n <span class="m">1000</span> filename <span class="p">|</span> tail
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-48"></a><span class="c1"># display to stdout</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-49"></a>$ <span class="nb">echo</span> SOMETHING
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-50"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-51"></a><span class="c1"># get list of all listened ports</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-52"></a>$ sudo netstat -peanut
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-53"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-54"></a><span class="c1"># check memory every 1 second</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-55"></a>$ watch -n <span class="m">1</span> free -m
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-56"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-57"></a><span class="c1"># as per tutorial: http://manpages.ubuntu.com/manpages/trusty/man1/enca.1.html</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-58"></a><span class="c1"># get coding of document</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-59"></a>$ enca filename
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-60"></a><span class="c1"># change encoding of doc</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-61"></a>$ enconv filename
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-62"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-63"></a><span class="c1"># merge all files in folder to one</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-64"></a>$ cat folder_path/* &gt; new_file
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-65"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-66"></a><span class="c1"># copy content of some text file(ssh for example)</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-67"></a>$ cat ~/.ssh/id_rsa.pub <span class="p">|</span> xclip -sel clip
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-68"></a><span class="c1"># the same for mac</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-69"></a>$ pbcopy &lt; ~/.ssh/id_rsa.pub
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-70"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-71"></a><span class="c1"># get source code of some package</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-72"></a>http://askubuntu.com/questions/167468/where-can-i-find-the-source-code-of-ubuntu
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-73"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-74"></a><span class="c1"># get dependencies</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-75"></a>$ readelf -d some_exe
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-76"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-77"></a><span class="c1"># find location of installed files</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-78"></a>$ dpkg --listfiles libqt4-dev
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-79"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-80"></a><span class="c1"># remove range of folders starts with numbers</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-81"></a>$ rm -r output/logs/<span class="o">{</span><span class="m">17</span>..26<span class="o">}</span>*
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-82"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-83"></a><span class="c1"># send stdout to file and display it to the bash at the same time</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-84"></a>$ ./some_file.sh <span class="p">|</span> tee -a logs.txt
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-85"></a>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-86"></a><span class="c1"># stop first running docker instance</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-87"></a><span class="c1"># all runing| second line| container name    | stop container by name</span>
<a name="rest_code_850d3653e3774ab0b6a0b6a7a0f0a086-88"></a>$ docker ps <span class="p">|</span> sed -n 2p  <span class="p">|</span> awk <span class="s1">'{print $NF}'</span> <span class="p">|</span> xargs docker stop
</pre>
</div>
</div>
    </div>
    
</article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2017         <a href="mailto:ikhlestov@gmail.com">Illarion Khlestov</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>          <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script></footer>
</div>
</div>

            <script src="../../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92406723-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>